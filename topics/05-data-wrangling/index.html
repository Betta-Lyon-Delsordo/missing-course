<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>/topics/05-data-wrangling [missing course]</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
  pre code {
      background-color: lightgoldenrodyellow;
      border-radius: 1.0rem;
      display: block;
      font-size: 0.8rem;
      padding: 1.0rem;
  }

  figcaption {
      font-size: 0.9rem;
      font-style: italic;
      text-align: center;
  }

  #before {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid black;
  }

  #after {
      display: flex;
      justify-content: space-between;
      border-top: 1px solid black;
  }
  </style>
</head>
<body>
<div id="banner">
    <img src="media/header.jpg" alt="Course Header">
</div>
<div id="before">
    The Missing Course
    <a href="../.." title="Course Home">Home</a>
    <a href="https://github.com/glesica/missing-course" title="Course GitHub Page">GitHub</a>
</div>
<h1 id="data-wrangling">Data Wrangling</h1>
<ul>
<li><a href="https://missing.csail.mit.edu/2020/data-wrangling/">MIT Page</a></li>
</ul>
<h2 id="regular-expressions">Regular Expressions</h2>
<p>Regular Expressions let us create patterns that we can match against text. The simplest possible pattern is just an exact string match. For example, the pattern <code>hello</code> is found within the string “hello world” at position 0.</p>
<p>More complicated patterns can express more interesting matches. For example, the pattern <code>[Hh]ello</code> will match “hello world” as well as “Hello world”. We can also limit matches to the beginning or end of a line, this is sometimes called “anchoring” the regular expression. The pattern <code>^hello</code> will match “hello world” but not “say hello” because <code>^</code> indicates the beginning of the line.</p>
<h2 id="sed">Sed</h2>
<ul>
<li><a href="https://www.grymoire.com/Unix/Sed.html">Tutorial</a> - unofficial but good</li>
</ul>
<p>The command everyone uses Sed for is <code>s</code> for substitution. Let’s look at an example. We’ll give ourselves a data file and then use Sed to slice and dice it in different ways. We’ll put that in a text file called, shockingly, <code>messages.txt</code>.</p>
<pre><code>2021-01-03 This is a message
2021-01-04 Also a message
2021-01-05 Another day, another message
2021-01-06 Something something message</code></pre>
<p>What if we wanted to trim the date off the beginning of each line?</p>
<pre><code>cat messages.txt | sed -r &#39;s/^[0-9]{4}-[0-9]{2}-[0-9]{2} //&#39;</code></pre>
<p>Breaking this down, we pipe the contents of the file into Sed. Sed is invoked with the <code>-r</code> flag so that we can use regular expressions. Finally, we have a Sed command that looks for a certain pattern and replaces it with nothing (<code>//</code>), which is the same as removing it.</p>
<p>What if we wanted to transform this file to CSV format and make the year, month, and day separate columns? That’s a little trickier, but really not so difficult (although we should keep in mind that if our messages have a lot of special characters the resulting CSV might be invalid).</p>
<pre><code>cat messages.txt | sed -E &#39;s/^([0-9]{4})-([0-9]{2})-([0-9]{2}) (.+)$/\1,\2,\3,\4/&#39;</code></pre>
<p>Wow, that’s a big one.</p>
<h2 id="awk">Awk</h2>
<h2 id="json-jq">JSON (jq)</h2>
<h2 id="csv-csvkit-and-csvtk">CSV (csvkit and csvtk)</h2>
<p>Comma-separated values files are very common in data analysis. Think of them as very simple Excel spreadsheets that just hold data and don’t do any processing or calculations. This simplicity is one reason for the popularity of the format, since CSV files can be read easily on virtually any platform.</p>
<p>We will look at two different tools for working with CSV data on the command line, but keep in mind that CSV files can also be loaded into ordinary spreadsheet applications, even Excel!</p>
<h3 id="csvkit">csvkit</h3>
<ul>
<li><a href="https://github.com/wireservice/csvkit">GitHub</a></li>
</ul>
<h3 id="csvtk">csvtk</h3>
<ul>
<li><a href="https://github.com/shenwei356/csvtk">GitHub</a></li>
</ul>

<div id="after">
    <a href="#">Back to top</a>
    <a href="../..">Home</a>
</div>
</body>
</html>
